---
title: "Emoji-æ­£åˆ™åŒ¹é…"
date: 2024-05-17 09:45:11
categories: [other]
tags: []
origin_url: https://taxodium.ink/post/emoji-regexp/
---
Emoji æ­£åˆ™åŒ¹é…
==========

2024-05-09

Contents
--------

*   [å‰è¨€](#headline-1)
*   [TL;DR](#headline-2)
*   [è§£å†³è¿‡ç¨‹](#headline-3)
*   [Unicode character class escpae](#headline-4)
*   [String & Unicode](#headline-5)
*   [ä¸ºä»€ä¹ˆ /(\\ud83c\[\\udf00-\\udfff\]â€¦/u çš„æ­£åˆ™æ— æ³•åŒ¹é…ğŸ‰](#headline-6)
*   [String ä¸­çš„ç›¸å…³æ–¹æ³•](#headline-7)
*   [æ³¨æ„ç‚¹](#headline-8)
    *   [å­—ç¬¦ä¸²é•¿åº¦](#headline-9)
    *   [Lone surrogates](#headline-10)
*   [Refs](#headline-11)

å‰è¨€
--

è¦æ±‚è¾“å…¥æ¡†èƒ½è¾“å…¥é™¤äº†ç‰¹æ®Šè¡¨æƒ…å¤–çš„ä»»æ„å­—ç¬¦ã€‚

æˆ‘çš„ç†è§£å°±æ˜¯å°† Emoji æ’é™¤æ‰ï¼Œé€šè¿‡ [RegExp](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp) åŒ¹é… Emoji åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç‰¹æ®Šè¡¨æƒ…ã€‚

TL;DR
-----

å¦‚æœä½ åªæ˜¯æƒ³è¦ä¸€ä¸ªèƒ½å¤ŸåŒ¹é…è¡¨æƒ…çš„æ­£åˆ™ï¼Œä¸‹é¢è¿™ä¸ªåº”è¯¥å°±æ»¡è¶³ğŸ‘‡ï¼š

    1
    2
    

        /\p{Extended_Pictographic}/gu.test("ä½ å¥½hello123ğŸ˜„hiğŸŒ·456ğŸ‰") // true
        /\p{Extended_Pictographic}/gu.test("ä½ å¥½hello123") // false

[![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/c4baa5f6.png)](https://taxodium.ink/post/emoji-regexp/regexp101-emoji-corret.png)

è§£å†³è¿‡ç¨‹
----

å¯¹äº Emoji è¿™ç§æ­£åˆ™ï¼Œä¸€å¼€å§‹æƒ³ä¸åˆ°å¦‚ä½•æ„å»ºï¼Œç†è®ºä¸Šå®ƒä¹Ÿæ˜¯å±äº Stringï¼Œå¤§è‡´çŸ¥é“ Emoji å’Œ Unicode ç›¸å…³ï¼Œä½†æ€ä¹ˆç”¨æ­£åˆ™æè¿°å®ƒå‘¢ï¼Ÿ

æ‰€ä»¥æˆ‘çš„ç¬¬ä¸€æ­¥æ˜¯ Googleï¼Œå¾—åˆ°ä¸€ä¸ªè¿™æ ·çš„æ­£åˆ™ï¼š

    1
    

        /(\ud83c[\udf00-\udfff])|(\ud83d[\udc00-\ude4f\ude80-\udeff])|[\u2600-\u2B55]/

æ‹¿å» [regex101](https://regex101.com/) æµ‹è¯•äº†ä¸€ä¸‹ï¼Œè™½ç„¶èƒ½åŒ¹é…åˆ°ä¸€äº› Emojiï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰éƒ¨åˆ† Emoji åŒ¹é…ä¸åˆ°ã€‚

[![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/6a9013b6.png)](https://taxodium.ink/post/emoji-regexp/regexp101-emoji-wrong.png)

ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼åº”è¯¥æ˜¯è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª Unicode èŒƒå›´ï¼Œéƒ¨åˆ† Emoji (ğŸ‰)æ²¡åŒ¹é…ä¸Šï¼Œè¯´æ˜è¿™ä¸ªèŒƒå›´å°äº†ï¼Œæ²¡æœ‰å›Šæ‹¬æ‰€æœ‰çš„ Emojiã€‚

é‚£ä¹ˆ Emoji çš„ Unicode èŒƒå›´æ˜¯å¤šå°‘ï¼Ÿæ˜¯ä¸æ˜¯ç©·ä¸¾å°±è¡Œäº†ï¼Ÿ

å…¶å®æ²¡åŠæ³•ç”¨ä¸€ä¸ªå›ºå®šçš„èŒƒå›´å»è¡¨è¾¾ï¼Œå› ä¸º Emoji æ˜¯æŒç»­å¢åŠ çš„ï¼Œæ¯å¢åŠ ä¸€ä¸ª Emoji å°±å¢åŠ ä¸€ä¸ªå¯¹åº”çš„ Unicode ï¼Œæ²¡åŠæ³•ç”¨ä¸€ä¸ªå›ºå®šçš„èŒƒå›´å»è¡¨è¾¾æ‰€æœ‰çš„ Emojiã€‚

äºæ˜¯åˆæœç´¢äº†ä¸€ä¸‹ï¼ŒStackOverflow æœ‰ä¸€ä¸ª[å›ç­”](https://stackoverflow.com/questions/18862256/how-to-detect-emoji-using-javascript)ï¼Œé‡Œé¢æåˆ°äº†ç”¨ [Unicode character class escape](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Unicode_character_class_escape) è¿›è¡ŒåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯ `/\p{Emoji}/u` å’Œ `/\p{Extended_Pictographic}/u` ã€‚

`/\p{Emoji}/u`

æ—¢ç„¶æ˜¯åŒ¹é… Emojiï¼Œé‚£ä¹ˆ loneProperty (\\p{loneProperty}) å°±åº”è¯¥æ˜¯ Emoji ? å®é™…æµ‹è¯•å¹¶ä¸ç¬¦åˆéœ€æ±‚ï¼Œå› ä¸ºåœ¨[Emoji å®˜æ–¹æ–‡æ¡£](https://www.unicode.org/Public/15.1.0/ucd/emoji/emoji-data.txt)ä¸­ï¼Œ `123456789*#` ä¹Ÿæ˜¯è¢«çœ‹ä½œæ˜¯ Emojiï¼Œ å¦‚æœç”¨è¿™ä¸ªæ­£åˆ™çš„è¯ï¼Œå°±ä¼šæŠŠæ•°å­—ä¹Ÿè®¤ä¸ºæ˜¯ Emojiï¼Œä¸ç¬¦åˆåªæ’é™¤ç‰¹æ®Šè¡¨æƒ…çš„è¦æ±‚ã€‚

`/\p{Extended_Pictographic}/u`

è€Œ Extended\_Pictographic è¡¨ç¤ºçš„ Emoji æ‰æ˜¯æˆ‘ä»¬è®¤ä¸ºçš„é‚£äº›è¡¨æƒ…ç¬¦å·ã€‚

     1
     2
     3
     4
     5
     6
     7
     8
     9
    10
    

      console.log(
        /\p{Emoji}/u.test('flowers'), // false :)
        /\p{Emoji}/u.test('flowers ğŸŒ¼ğŸŒºğŸŒ¸'), // true :)
        /\p{Emoji}/u.test('flowers 123'), // true :(
      )
      console.log(
        /\p{Extended_Pictographic}/u.test('flowers'), // false :)
        /\p{Extended_Pictographic}/u.test('flowers ğŸŒ¼ğŸŒºğŸŒ¸'), // true :)
        /\p{Extended_Pictographic}/u.test('flowers 123'), // false :)
      )

Unicode character class escpae
------------------------------

[Unicode character class escape: \\p{â€¦}, \\P{â€¦}](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Unicode_character_class_escape) æ˜¯ [Character class escape](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Character_class_escape) ä¸­çš„ä¸€ç§ã€‚

å¹³æ—¶æ­£åˆ™ä¸­å¸¸ç”¨çš„ \\d,\\D,\\w,\\W å°±æ˜¯ Character class escapeï¼Œå°±æ˜¯ç”¨æ¥è¡¨è¾¾ä¸€ç»„å­—ç¬¦çš„è½¬ä¹‰åºåˆ—(escape sequence)ã€‚

ä¾‹å¦‚ `\d` è¿™ä¸ªè½¬ä¹‰åºåˆ—è¡¨è¾¾çš„å°±æ˜¯ `[0-9]` çš„ä¸€ç»„å­—ç¬¦ ã€‚

è€Œ `\p{...}` , `\P{...}` ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯ä»–ä»¬ç”¨æ¥è¡¨è¾¾ä¸€ç»„ Unicdoe å­—ç¬¦ï¼Œé€šè¿‡æŒ‡å®š [Unicode property](https://tc39.es/ecma262/multipage/text-processing.html#table-binary-unicode-properties) å†³å®šåŒ¹é…ä»€ä¹ˆ Unicodeã€‚

ä¾‹å¦‚å¯ä»¥ç”¨ `/\p{Hex_Digit}/u` å»åŒ¹é… 16 è¿›åˆ¶çš„å­—ç¬¦ï¼š

[![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/8d982b1c.png)](https://taxodium.ink/post/emoji-regexp/regexp101-emoji-hex-digit.png)

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ Unicode character class escpae è¦å¯ç”¨ [unicode-aware mode](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/unicode#unicode-aware_mode)ï¼Œå³åŠ ä¸Š `/u` æ ‡è®°ã€‚

String & Unicode
----------------

> Strings are represented fundamentally as sequences of [UTF-16](https://en.wikipedia.org/wiki/UTF-16) code units. In UTF-16 encoding, every code unit is exact 16 bits long. This means there are a maximum of 2^16, or 65536 possible characters representable as single UTF-16 code units.
> 
> â€¦
> 
> However, the entire Unicode character set is much, much bigger than 65536. The extra characters are stored in UTF-16 as surrogate pairs, which are pairs of 16-bit code units that represent a single character.To avoid ambiguity, the two parts of the pair must be between 0xD800 and 0xDFFF, and these code units are not used to encode single-code-unit characters. (More precisely, leading surrogates, also called **high-surrogate** code units, have values between **0xD800 and 0xDBFF**, inclusive, while trailing surrogates, also called **low-surrogate** code units, have values between **0xDC00 and 0xDFFF**, inclusive.) Each Unicode character, comprised of one or two UTF-16 code units, is also called a **Unicode code point**. Each Unicode code point can be written in a string with \\u{xxxxxx} where xxxxxx represents 1â€“6 hex digits.
> 
> â€”â€” [UTF-16 characters, Unicode code points, and grapheme clusters](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#utf-16_characters_unicode_code_points_and_grapheme_clusters)

åœ¨ JavaScript ä¸­ï¼ŒString å®é™…æ˜¯ UTF-16 (16-bit Unicode Transformation Format) ç¼–ç çš„ï¼Œå®ƒä»¥ 16 ä½å»è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼ˆcode unitï¼‰ï¼Œæœ€å¤šå¯ä»¥è¡¨ç¤º 65536 (0x0000 - 0xFFFF) ä¸ªå­—ç¬¦ã€‚

è¿™ 65535 ä¸ªå­—ç¬¦ä¸­åŒ…å«äº†å¤§éƒ¨åˆ†å¸¸ç”¨å­—ç¬¦ï¼Œä¾‹å¦‚å­—æ¯ï¼Œæ•°å­—ï¼Œæ‹‰ä¸å­—ç¬¦ï¼Œä»¥åŠä¸€äº›ä¸œäºšæ–‡å­—å­—ç¬¦ã€‚

ä½†æ˜¯åæ¥å‘ç° 65535 å¹¶ä¸è¶³ä»¥è¡¨è¾¾æ‰€æœ‰å­—ç¬¦ï¼Œ16 ä½ä¸å¤Ÿï¼Œé‚£å°±éœ€è¦å¢åŠ  Unicode å»è¡¨è¾¾æ›´å¤šå­—ç¬¦ã€‚

å®ç°çš„æ–¹æ³•å°±æ˜¯å®šä¹‰äº† **ä»£ç†å¯¹ (Surrogates pairs)** , ä»£ç†å¯¹ç”± 20 ä½ç»„æˆã€‚

è§„å®šå‰ 10 ä½ä½œä¸º **é«˜ä»£ç†ä½ (high-surrogate)** ï¼Œå–å€¼èŒƒå›´æ˜¯ 0xD800 - 0xDBFFã€‚

å 10 ä½ä¸º **ä½ä»£ç†ä½ (low-surrogate)** ï¼Œå–å€¼èŒƒå›´æ˜¯ 0xDC00 - 0xDFFFã€‚

é«˜ä»£ç†ä½å’Œä½ä»£ç†ä½ç»„æˆä»£ç†å¯¹ (surrogate pairs) ã€‚

ç”±äºæœ‰ 20 ä½çš„é•¿åº¦ï¼Œå› æ­¤å¯ä»¥è¡¨è¾¾ 1048576 ä¸ªå­—ç¬¦ï¼Œå¯ä»¥åœ¨åŸæ¥ 65536 ä¸ªå­—ç¬¦ä¹‹ä¸Šï¼Œå†å¢åŠ  1048576 ä¸ªå­—ç¬¦ã€‚

ä¸ºä»€ä¹ˆ Unicode è¦è¿™ä¹ˆè®¾è®¡ï¼Œå¯ä»¥å‚è€ƒ [Why does code points between U+D800 and U+DBFF generate one-length string in ECMAScript 6?](https://stackoverflow.com/questions/42181070/why-does-code-points-between-ud800-and-udbff-generate-one-length-string-in-ecm)

ä¸ºä»€ä¹ˆé«˜ä»£ç†å’Œä½ä»£ç†è¿™ä¹ˆå–å€¼ï¼Œå¯ä»¥å‚è€ƒ [How was the position of the Surrogates Area (UTF-16) chosen?](https://stackoverflow.com/questions/5178202/how-was-the-position-of-the-surrogates-area-utf-16-chosen)ï¼‰

æ¦‚æ‹¬æ¥è¯´ï¼Œå°±æ˜¯åœ¨ JavaScript çš„ String ä¸­å¸¸ç”¨çš„å­—ç¬¦ï¼ˆå¦‚å­—æ¯ï¼Œæ•°å­—ï¼Œæ±‰å­—ï¼‰æ˜¯ç”± 1 ä¸ª UTF-16 ç¼–ç å•å…ƒè¡¨ç¤ºçš„ã€‚

è€Œè¶…å‡º 65535 (0xFFFF, U+FFFF, \\uFFFF) å­—ç¬¦ï¼ˆå¦‚ Emojiï¼‰ï¼Œåˆ™ç”±ä»£ç†å¯¹è¡¨ç¤ºï¼ˆé«˜ä»£ç†+ä½ä»£ç†ï¼Œ2 ä¸ª UTF-16 ç¼–ç å•å…ƒï¼‰ã€‚

ä¸ºä»€ä¹ˆ /(\\ud83c\[\\udf00-\\udfff\]â€¦/u çš„æ­£åˆ™æ— æ³•åŒ¹é…ğŸ‰
---------------------------------------------

ç°åœ¨å·²ç»çŸ¥é“ Emoji æ˜¯é€šè¿‡ä»£ç†å¯¹è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆ ğŸ‰ çš„ä»£ç†å¯¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

å¯ä»¥é€šè¿‡ [String.prototype.chartAt()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charAt) æˆ– [String.prototype.split()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split) è·å¾—ã€‚

    1
    2
    3
    

      'ğŸ‰'.charAt(0) // '\uD83C'
      'ğŸ‰'.charAt(1) // '\uDE50'
      'ğŸ‰'.split("") // ['\uD83C', '\uDE50']
    

æ‰€ä»¥ ğŸ‰ çš„é«˜ä»£ç†æ˜¯ \\uD83Cï¼Œä½ä»£ç†æ˜¯ \\uDE50ã€‚

å’Œ `(\ud83c[\udf00-\udfff])|(\ud83d[\udc00-\ude4f\ude80-\udeff])|[\u2600-\u2B55]` å¯¹æ¯”å¯ä»¥å‘ç°ï¼Œæ­£åˆ™çš„èŒƒå›´ä¸åŒ…æ‹¬ \\uD83C\\uDE50ï¼Œæ‰€ä»¥åŒ¹é…ä¸åˆ°ğŸ‰ã€‚

String ä¸­çš„ç›¸å…³æ–¹æ³•
-------------

[String.prototype.charAt()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charAt)

> The charAt() method of String values returns a new string consisting of the single UTF-16 code unit at the given index.

charAt() è¿”å›å­—ç¬¦ä¸²å¯¹åº”ä¸‹æ ‡çš„å•ä¸ª UTF-16 ç¼–ç å•å…ƒã€‚

    1
    2
    3
    4
    5
    6
    7
    8
    

        'ğŸ‰'.charAt(0) // '\uD83C'
        'ğŸ‰'.charAt(1) // '\uDE50'
    
        'a'.charAt(0) // 'a'
        'a'.charAt(1) // ''
    
        'apple'.charAt(0) // 'a'
        'apple'.charAt(1) // 'p'
    

[String.property.charCodeAt()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt)

> The charCodeAt() method of String values returns an integer between 0 and 65535 representing the UTF-16 code unit at the given index.

charCodeAt() è¿”å›å­—ç¬¦ä¸€ä¸ª `0-65535` ä¹‹é—´çš„ `æ•°å­—(integer)` , æ˜¯å­—ç¬¦ä¸²å¯¹åº”ä¸‹æ ‡çš„ UTF-16 ç¼–ç å•å…ƒå¯¹åº”çš„æ•°å€¼ã€‚

    1
    2
    3
    4
    5
    6
    7
    8
    

        'ğŸ‰'.charCodeAt(0) // 55356
        'ğŸ‰'.charCodeAt(1) // 56912
    
        'a'.charCodeAt(0) // 97
        'a'.charCodeAt(1) // NaN
    
        'apple'.charCodeAt(0) // 97
        'apple'.charCodeAt(1) // 112
    

[String.fromCharCode()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode)

> The String.fromCharCode() static method returns a string created from the specified sequence of UTF-16 code units.

fromCharCode() å¯ä»¥æ¥å—å¤šä¸ª 0-65535 ä¹‹é—´çš„æ•°å­—ï¼Œè¿”å›è¿™äº› char code ç»„æˆçš„å­—ç¬¦ä¸²ã€‚

fromCharCode() å’Œ charCodeAt() æ˜¯å¯¹åº”çš„ã€‚

     1
     2
     3
     4
     5
     6
     7
     8
     9
    10
    

        'ğŸ‰'.charCodeAt(0) // 55356
        'ğŸ‰'.charCodeAt(1) // 56912
        String.fromCharCode(55356, 56912) // 'ğŸ‰'
    
        'apple'.charCodeAt(0) // 97
        'apple'.charCodeAt(1) // 112
        'apple'.charCodeAt(2) // 112
        'apple'.charCodeAt(3) // 108
        'apple'.charCodeAt(4) // 101
        String.fromCharCode(97, 112, 112, 108, 101) // 'apple'
    

[String.prototype.codePointAt()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt)

> The codePointAt() method of String values returns a non-negative integer that is the Unicode code point value of the character starting at the given index.
> 
> Note that the index is still based on UTF-16 code units, not Unicode code points.

codePointAt() è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæ˜¯å­—ç¬¦ä¸²å¯¹åº”ä¸‹æ ‡çš„å¯¹åº”çš„ Unicode code point(ä¸å±€é™åœ¨ 0-65535, è€Œæ˜¯ 0-1114111 (0x10FFFF))ã€‚

    1
    2
    3
    4
    5
    6
    7
    8
    

      'ğŸ‰'.charCodeAt(0) // 55356
      'ğŸ‰'.charCodeAt(1) // 56912
    
      'ğŸ‰'.codePointAt(0) // 127568
      // éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‹æ ‡æ˜¯åŸºäº UTF-16 è®¡ç®—çš„ï¼ŒğŸ‰ æ˜¯ç”±ä¸¤ä¸ª UTF-16 ç»„æˆçš„
      // å¯¹äºä¸‹æ ‡ 0ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªä»£ç†å¯¹ï¼Œå¯¹åº” Unicode code pointï¼Œæ‰€ä»¥è¿”å›äº† 127568
      // å¯¹äºä¸‹æ ‡ 1ï¼Œç”±äºåªæœ‰ä½ä»£ç†ä½ï¼Œæ— æ³•ç»„æˆä»£ç†å¯¹ï¼Œå°±è¿”å›ä½ä»£ç†ä½å¯¹åº”çš„ Unicode Code Point
      'ğŸ‰'.codePointAt(1) // 56912
    

[String.fromCodePoint()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint)

> The String.fromCodePoint() static method returns a string created from the specified sequence of code points.

fromCodePoint() å¯ä»¥æ¥å—å¤šä¸ª codePoint æ•°å­—ï¼Œè¿”å›å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚

fromCharCode() çš„æ¯ä¸ªå‚æ•°åªèƒ½æ˜¯ 0-65535 èŒƒå›´çš„æ•°å­—ï¼Œè€Œ fromCodePoint() åˆ™å¯ä»¥è¾“å…¥ 0-1114111 èŒƒå›´çš„æ•°å­—ã€‚

     1
     2
     3
     4
     5
     6
     7
     8
     9
    10
    11
    

      // fromCodePoint
      String.fromCodePoint(127568) // 'ğŸ‰'
      String.fromCodePoint(55356, 56912) // 'ğŸ‰'
    
      // fromCharCode
      // fromCharCode åªèƒ½å¤„ç† 0-65535 ä¹‹é—´çš„æ•°å­—ï¼Œå¯¹äºè¶…è¿‡ 65535 çš„æ•°å­—ï¼Œåˆ™æˆªæ–­åˆ°æœ€åçš„ 16 ä½æ•°å­—
      // ç­‰åŒäº String.fromCharCode(62032)
      // Number(127568).toString(16) -> '1f250' -> æˆªå–æœ€åçš„ 16 ä½ï¼Œå³ f250
      // Number.parseInt('f250', 16) -> 62032
      String.fromCharCode(127568) // 'ï‰'
      String.fromCharCode(55356, 56912) // 'ğŸ‰'
    

æ³¨æ„ç‚¹
---

### å­—ç¬¦ä¸²é•¿åº¦

æœ‰çš„å­—ç¬¦æ˜¯ç”±ä»£ç†å¯¹ç»„æˆçš„ï¼Œæ˜¯ä¸¤ä¸ª UTF-16 ç¼–ç å•å…ƒï¼Œä¾‹å¦‚ Emojiã€‚

å½“éœ€è¦è®¡ç®—ä»–ä»¬é•¿åº¦çš„æ—¶å€™ï¼Œéœ€è¦æ„è¯†åˆ°ä»–ä»¬æ˜¯ä»£ç†å¯¹ï¼Œå–å†³äºå…·ä½“éœ€æ±‚å»ç»Ÿè®¡é•¿åº¦ã€‚

    1
    2
    3
    

      'a'.length // 1
    
      'ğŸ‰'.length // 2
    

### Lone surrogates

ä»£ç†å¯¹æ˜¯ç”±é«˜ä»£ç†å’Œä½ä»£ç†ç»„æˆçš„ï¼Œå¦‚æœå•ç‹¬æŠŠé«˜ä»£ç†æ‹å‡ºæ¥ï¼Œæˆ–è€…é«˜ä»£ç†å’Œé«˜ä»£ç†ç»„æˆä»£ç†å¯¹ï¼Œæ˜¯æ— æ³•è¡¨è¾¾æœ‰å«æ„çš„ Unicode å­—ç¬¦çš„ã€‚

å…·ä½“å¯ä»¥å‚è€ƒ [UTF-16 characters, Unicode code points, and grapheme clusters](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#utf-16_characters_unicode_code_points_and_grapheme_clusters)ã€‚

Refs
----

*   [How to detect emoji using javascript](https://stackoverflow.com/questions/18862256/how-to-detect-emoji-using-javascript)*   [Unicode character class escape: \\p{â€¦}, \\P{â€¦}](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Unicode_character_class_escape)*   [Binary Unicode property aliases and their canonical property names](https://tc39.es/ecma262/multipage/text-processing.html#table-binary-unicode-properties)
    