---
title: "ç”±æµ…å…¥æ·±äº†è§£ Base64 ç¼–ç è§£ç "
date: 2023-05-19 10:13:25
categories: [other]
tags: []
origin_url: https://juejin.cn/post/7234060695255154749
---
> æ–‡ç« é¦–å‘äº[è¢‹é¼ äº‘æ•°æ ˆUEDå›¢é˜Ÿ](https://juejin.cn/post/7221373067230347322)

å‰è¨€
--

åœ¨ç¬”è€…å…¬å¸å†…éƒ¨ï¼Œè¶Šæ¥è¶Šå¤šçš„åº”ç”¨åˆ°ç›¸å…³çš„ç¼–ç å†…å®¹ï¼Œè¾ƒå¤šçš„é‡‡ç”¨ Base64 ç¼–ç æ¥åŠ å¯†ä¸€äº› SQLã€‚

èƒ½å¤Ÿå‘ç°æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œä½¿ç”¨çš„ window å¯¹è±¡ä¸Šçš„ btoa æ–¹æ³•å®ç°çš„ Base64 ç¼–ç ï¼Œé‚£ btoa å…·ä½“æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿå°†åœ¨ä¸‹é¢çš„å†…å®¹ä¸­ä¸ºå¤§å®¶è®²è§£ã€‚

é‚£æˆ‘ä»¬å°±å…ˆä»ä¸€äº›åŸºç¡€çŸ¥è¯†å¼€å§‹æ·±å…¥äº†è§£å§~

  

ä»€ä¹ˆæ˜¯ç¼–ç 
-----

ç¼–ç ï¼Œæ˜¯ä¿¡æ¯ä»ä¸€ç§å½¢å¼è½¬å˜ä¸ºå¦ä¸€ç§å½¢å¼çš„è¿‡ç¨‹ï¼Œç®€è¦æ¥è¯´å°±æ˜¯è¯­è¨€çš„ç¿»è¯‘ã€‚

å°†æœºå™¨è¯­è¨€(äºŒè¿›åˆ¶)è½¬å˜ä¸ºè‡ªç„¶è¯­è¨€ã€‚

  

äº”èŠ±å…«é—¨çš„ç¼–ç 
-------

### ASCII ç 

ASCII ç æ˜¯ä¸€ç§å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œç”¨äºå°†æ•°å­—ã€å­—æ¯å’Œå…¶ä»–å­—ç¬¦è½¬æ¢ä¸ºè®¡ç®—æœºå¯ä»¥ç†è§£çš„äºŒè¿›åˆ¶æ•°ã€‚

å®ƒæœ€åˆæ˜¯ç”±ç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†æ‰€åˆ¶å®šçš„ï¼Œå®ƒåŒ…å«äº† 128 ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­åŒ…æ‹¬äº†æ•°å­—ã€å¤§å°å†™å­—æ¯ã€æ ‡ç‚¹ç¬¦å·ã€æ§åˆ¶å­—ç¬¦ç­‰ç­‰ã€‚

åœ¨è®¡ç®—æœºä¸­ä¸€ä¸ªå­—èŠ‚å¯ä»¥è¡¨ç¤º256ä¼—ä¸åŒçš„çŠ¶æ€ï¼Œå°±å¯¹åº”256å­—ç¬¦ï¼Œä» 00000000 åˆ° 11111111ã€‚ASCII ç ä¸€å…±è§„å®šäº†128å­—ç¬¦ï¼Œæ‰€ä»¥åªéœ€è¦å ç”¨ä¸€ä¸ªå­—èŠ‚çš„åé¢7ä½ï¼Œæœ€å‰é¢ä¸€ä½å‡ä¸º0ï¼Œæ‰€ä»¥ ASCII ç å¯¹åº”çš„äºŒè¿›åˆ¶ä½ 00000000 åˆ° 01111111ã€‚

![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/e8e0c8e8.webp)

### é ASCII ç 

å½“å…¶ä»–å›½å®¶éœ€è¦ä½¿ç”¨è®¡ç®—æœºæ˜¾ç¤ºçš„æ—¶å€™å°±æ— æ³•ä½¿ç”¨ ASCII ç å¦‚æ­¤å°‘é‡çš„æ˜ å°„æ–¹æ³•ã€‚å› æ­¤æŠ€æœ¯é©æ–°å¼€å§‹å•¦ã€‚

*   GB2312
*   æ”¶å½•äº†6700+çš„æ±‰å­—ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚ä½œä¸ºç¼–ç å­—ç¬¦é›†çš„ç©ºé—´
*   GBK
*   GBK åœ¨ä¿è¯ä¸å’Œ GB2312/ASCII å†²çªçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚çš„æ–¹å¼ç¼–ç äº†æ›´å¤šçš„æ±‰å­—ï¼Œè¾¾åˆ°äº†2w
*   ç­‰ç­‰

  

å…¨é¢ç»Ÿä¸€çš„ Unicode
-------------

é¢å¯¹äº”èŠ±å…«é—¨çš„ç¼–ç æ–¹å¼ï¼ŒåŒä¸€ä¸ªäºŒè¿›åˆ¶æ•°ä¼šè¢«è§£é‡Šä¸ºä¸åŒçš„ç¬¦å·ï¼Œå¦‚æœä½¿ç”¨é”™è¯¯çš„ç¼–ç çš„æ–¹å¼å»è¯»åŒºæ–‡ä»¶ï¼Œå°±ä¼šå‡ºç°ä¹±ç çš„é—®é¢˜ã€‚

é‚£èƒ½å¦åˆ›å»ºä¸€ç§ç¼–ç èƒ½å¤Ÿå°†æ‰€æœ‰çš„ç¬¦å·çº³å…¥å…¶ä¸­ï¼Œæ¯ä¸€ä¸ªç¬¦å·éƒ½æœ‰å”¯ä¸€å¯¹åº”çš„ç¼–ç ï¼Œé‚£ä¹ˆä¹±ç é—®é¢˜å°±ä¼šæ¶ˆå¤±ã€‚å› æ­¤ Unicode å€Ÿæ­¤æœºä¼šç»Ÿä¸€æ±Ÿæ¹–ã€‚æ˜¯ç”±ä¸€ä¸ªå«åš [Unicode è”ç›Ÿ](https://link.juejin.cn/?target=https%3A%2F%2Fzh.wikipedia.org%2Fwiki%2FUnicode)çš„å®˜æ–¹ç»„ç»‡åœ¨ç»´æŠ¤ã€‚

Unicode æœ€å¸¸ç”¨çš„å°±æ˜¯ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦(å¦‚æœæ˜¯æ›´ä¸ºååƒ»çš„å­—ç¬¦ï¼Œå¯èƒ½æ‰€éœ€å­—èŠ‚æ›´å¤š)ã€‚ç°ä»£æ“ä½œç³»ç»Ÿéƒ½ç›´æ¥æ”¯æŒ Unicodeã€‚

> Unicode å’Œ ASCII çš„åŒºåˆ«

*   ASCII ç¼–ç é€šå¸¸æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼ŒUnicode ç¼–ç é€šå¸¸æ˜¯ä¸¤ä¸ªå­—èŠ‚.
*   å­—æ¯ A ç”¨ ASCII ç¼–ç åè¿›åˆ¶ä¸º 65ï¼ŒäºŒè¿›åˆ¶ä½ 01000001ï¼›è€Œåœ¨ Unicode ç¼–ç ä¸­ï¼Œéœ€è¦åœ¨å‰é¢å…¨éƒ¨è¡¥0ï¼Œå³ä¸º 00000000 01000001
*   é—®é¢˜äº§ç”Ÿäº†ï¼Œè™½ç„¶ä½¿ç”¨ Unicode è§£å†³ä¹±ç çš„é—®é¢˜ï¼Œä½†æ˜¯ä¸ºçº¯è‹±æ–‡çš„æƒ…å†µï¼Œå­˜å‚¨ç©ºé—´ä¼šå¤§ä¸€å€ï¼Œä¼ è¾“å’Œå­˜å‚¨éƒ½ä¸åˆ’ç®—ã€‚

  

é—®é¢˜å¯¹åº”çš„è§£å†³æ–¹æ¡ˆä¹‹UTF-8
---------------

UTF-8 å…¨åä¸º 8-bit Unicode Transformation Format

æœ¬ç€èŠ‚çº¦çš„ç²¾ç¥ï¼Œåˆå‡ºç°äº†æŠŠ Unicode ç¼–ç è½¬ä¸ºå¯å˜é•¿ç¼–ç çš„ UTF-8ã€‚å¯ä»¥æ ¹æ®ä¸åŒå­—ç¬¦è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ï¼Œä½¿ç”¨1~4å­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ã€‚UTF-8 æ˜¯ Unicode çš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚

### UTF-8 çš„ç¼–ç è§„åˆ™

1.  å¯¹äºå•å­—èŠ‚çš„ç¬¦å·ï¼Œå­—èŠ‚çš„ç¬¬ä¸€ä½è®¾ç½®ä¸º0ï¼Œåé¢ä¸ƒä½ä¸ºè¯¥å­—ç¬¦çš„ Unicode ç ã€‚å› æ­¤å¯¹äºè‹±æ–‡å­—æ¯ï¼ŒUTF-8 ç¼–ç å’Œ ASCII ç¼–ç æ˜¯ç›¸åŒçš„ã€‚
2.  å¯¹äº n å­—èŠ‚çš„ç¬¦å·ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰ n ä½éƒ½æ˜¯1ï¼Œç¬¬ n+1 ä½ä¸º0ï¼Œåé¢çš„å­—èŠ‚çš„å‰ä¸¤ä½å‡ä¸º10ã€‚å‰©ä¸‹çš„ä½æ‰€å¡«å……çš„äºŒè¿›åˆ¶å°±æ˜¯è¿™ä¸ªå­—ç¬¦çš„ Unicode ç 

å¯¹åº”çš„ç¼–ç è¡¨æ ¼

Unicode ç¬¦å·èŒƒå›´UTF-8 ç¼–ç æ–¹å¼0000 0000-0000 007F (0-127)0xxxxxxx0000 0080-0000 07FF (128-2047)110xxxxx 10xxxxxx0000 0800-0000 FFFF (2048-65535)1110xxxx 10xxxxxx 10xxxxxx0001 0000-0010 FFFF (65536å¾€ä¸Š)11110xxx 10xxxxxx 10xxxxxx 10xxxxxxxåœ¨ Unicode å¯¹åº”è¡¨ä¸­æŸ¥æ‰¾åˆ°â€œæªâ€æ‰€åœ¨çš„ä½ç½®ï¼Œä»¥åŠå…¶å¯¹åº”çš„åå…­è¿›åˆ¶ 676Aï¼Œå¯¹åº”çš„åè¿›åˆ¶ä¸º 26474(110011101101010)ï¼Œå¯¹åº”ä¸‰ä¸ªå­—èŠ‚ 1110xxxx 10xxxxxx 10xxxxxx

å°†110011101101010çš„æœ€åä¸€ä¸ªäºŒè¿›åˆ¶ä¾æ¬¡å¡«å……åˆ°1110xxxx 10xxxxxx 10xxxxxxä»åå¾€å‰çš„ x ï¼Œå¤šå‡ºçš„ä½è¡¥0å³å¯ï¼Œä¸­ï¼Œå¾—åˆ°11100110 10011101 10101010 ï¼Œè½¬æ¢å¾—åˆ°39a76aï¼Œå³æ˜¯æªå­—å¯¹åº”çš„ UTF-8 çš„ç¼–ç 

![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/7199a6c5.webp)

*   \>\> å‘å³ç§»åŠ¨ï¼Œå‰é¢è¡¥ 0, å¦‚ 104 \>\> 2 å³ 01101000=\> 00011010
*   & ä¸è¿ç®—ï¼Œåªæœ‰ä¸¤ä¸ªæ“ä½œæ•°ç›¸åº”çš„æ¯”ç‰¹ä½éƒ½æ˜¯ 1 æ—¶ï¼Œç»“æœæ‰ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚å¦‚ 104 & 3å³ 01101000 & 00000011 =\> 00000000ï¼Œ& è¿ç®—ä¹Ÿç”¨åœ¨å–ä½æ—¶
*   | æˆ–è¿ç®—ï¼Œå¯¹äºæ¯ä¸€ä¸ªæ¯”ç‰¹ä½ï¼Œå½“ä¸¤ä¸ªæ“ä½œæ•°ç›¸åº”çš„æ¯”ç‰¹ä½è‡³å°‘æœ‰ä¸€ä¸ª 1 æ—¶ï¼Œç»“æœä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚å¦‚ 01101000 | 00000011 =\> 01101011

function unicodeToByte(input) {
    if (!input) return;
    const byteArray = \[\];
    for (let i = 0; i < input.length; i++) {
        const code = input.charCodeAt(i); // è·å–åˆ°å½“å‰å­—ç¬¦çš„ Unicode ç 
        if (code < 127) {
            byteArray.push(code);
        } else if (code \>\= 128 && code < 2047) {
            byteArray.push((code \>\> 6) | 192);
            byteArray.push((code & 63) | 128);
        } else if (code \>\= 2048 && code < 65535) {
            byteArray.push((code \>\> 12) | 224);
            byteArray.push(((code \>\> 6) & 63) | 128);
            byteArray.push((code & 63) | 128);
        }
    }
    return byteArray.map((item) =\> parseInt(item.toString(2)));
}

  

é—®é¢˜å¯¹åº”çš„è§£å†³æ–¹æ¡ˆä¹‹UTF-16
----------------

UTF-16 å…¨åä¸º 16-bit Unicode Transformation Format åœ¨ Unicode ç¼–ç ä¸­ï¼Œæœ€å¸¸ç”¨çš„å­—ç¬¦æ˜¯0-65535ï¼ŒUTF-16 å°†0â€“65535èŒƒå›´å†…çš„å­—ç¬¦ç¼–ç æˆ2ä¸ªå­—èŠ‚ï¼Œè¶…è¿‡è¿™ä¸ªçš„ç”¨4ä¸ªå­—èŠ‚ç¼–ç 

### UTF-16 ç¼–ç è§„åˆ™

1.  å¯¹äº Unicode ç å°äº 0x10000 çš„å­—ç¬¦ï¼Œ ä½¿ç”¨2ä¸ªå­—èŠ‚å­˜å‚¨ï¼Œå¹¶ä¸”æ˜¯ç›´æ¥å­˜å‚¨ Unicode ç ï¼Œä¸ç”¨è¿›è¡Œç¼–ç è½¬æ¢
2.  å¯¹äº Unicode ç åœ¨ 0x10000 å’Œ 0x10FFFF ä¹‹é—´çš„å­—ç¬¦ï¼Œä½¿ç”¨ 4 ä¸ªå­—èŠ‚å­˜å‚¨ï¼Œè¿™ 4 ä¸ªå­—èŠ‚åˆ†æˆå‰åä¸¤éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†å„ä¸¤ä¸ªå­—èŠ‚ï¼Œå…¶ä¸­ï¼Œå‰é¢ä¸¤ä¸ªå­—èŠ‚çš„å‰ 6 ä½äºŒè¿›åˆ¶å›ºå®šä¸º 110110ï¼Œåé¢ä¸¤ä¸ªå­—èŠ‚çš„å‰ 6 ä½äºŒè¿›åˆ¶å›ºå®šä¸º 110111ï¼Œå‰åéƒ¨åˆ†å„å‰©ä½™ 10 ä½äºŒè¿›åˆ¶è¡¨ç¤ºç¬¦å·çš„ Unicode ç  å‡å» 0x10000 çš„ç»“æœ
3.  å¤§äº 0x10FFFF çš„ Unicode ç æ— æ³•ç”¨ UTF-16 ç¼–ç 

å¯¹åº”çš„ç¼–ç è¡¨æ ¼

Unicode ç¬¦å·èŒƒå›´å…·ä½“Unicodeç UTF-16 ç¼–ç æ–¹å¼å­—èŠ‚0000 0000-0000 FFFF (0-65535)xxxxxxxx xxxxxxxxxxxxxxxx xxxxxxxx2å­—èŠ‚0001 0000-0010 FFFF (65536å¾€ä¸Š)yy yyyyyyyy xx xxxxxxxx110110yy yyyyyyyy 110111xx xxxxxxxx4å­—èŠ‚â€œæªâ€å­—çš„ Unicode ç ä¸º 676A(26474)ï¼Œå°äº 65535ï¼Œæ‰€ä»¥å¯¹åº”çš„ UTF-16 ç¼–ç ä¹Ÿä¸º 676A æ‰¾ä¸€ä¸ªå¤§äº 0x10000 çš„å­—ç¬¦ï¼Œ[0x1101F](https://link.juejin.cn/?target=https%3A%2F%2Fsymbl.cc%2Fcn%2F1101F%2F)ï¼Œè¿›è¡Œ UTF-16 ç¼–ç  ![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/04a8da27.webp)

  

å­—èŠ‚åº
---

å¯¹äºä¸Šè¿°è®²åˆ°çš„ UTF-16 æ¥è¯´ï¼Œå®ƒå­˜åœ¨ä¸€ä¸ªå­—èŠ‚åºçš„æ¦‚å¿µã€‚

å­—èŠ‚åºå°±æ˜¯å­—èŠ‚ä¹‹é—´çš„é¡ºåºï¼Œå½“ä¼ è¾“æˆ–è€…å­˜å‚¨æ—¶ï¼Œå¦‚æœè¶…è¿‡ä¸€ä¸ªå­—èŠ‚ï¼Œéœ€è¦æŒ‡å®šå­—èŠ‚é—´çš„é¡ºåºã€‚

æœ€å°ç¼–ç å•å…ƒæ˜¯å¤šå­—èŠ‚æ‰ä¼šæœ‰å­—èŠ‚åºçš„é—®é¢˜å­˜åœ¨ï¼ŒUTF-8 æœ€å°ç¼–ç å•å…ƒæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å®ƒæ˜¯æ²¡æœ‰å­—èŠ‚åºçš„é—®é¢˜ï¼ŒUTF-16 æœ€å°ç¼–ç å•å…ƒæ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œåœ¨è§£æä¸€ä¸ª UTF-16 å­—ç¬¦ä¹‹å‰ï¼Œéœ€è¦çŸ¥é“æ¯ä¸ªç¼–ç å•å…ƒçš„å­—èŠ‚åºã€‚

> ä¸ºä»€ä¹ˆä¼šå‡ºç°å­—èŠ‚åºï¼Ÿ

> è®¡ç®—æœºç”µè·¯å…ˆå¤„ç†ä½ä½å­—èŠ‚ï¼Œæ•ˆç‡æ¯”è¾ƒé«˜ï¼Œå› ä¸ºè®¡ç®—éƒ½æ˜¯ä»ä½ä½å¼€å§‹çš„ã€‚æ‰€ä»¥ï¼Œè®¡ç®—æœºçš„å†…éƒ¨å¤„ç†éƒ½æ˜¯å°ç«¯å­—èŠ‚åºã€‚ä½†æ˜¯ï¼Œäººç±»è¿˜æ˜¯ä¹ æƒ¯è¯»å†™å¤§ç«¯å­—èŠ‚åºã€‚

> æ‰€ä»¥ï¼Œé™¤äº†è®¡ç®—æœºçš„å†…éƒ¨å¤„ç†ï¼Œå…¶ä»–çš„åœºåˆæ¯”å¦‚ç½‘ç»œä¼ è¾“å’Œæ–‡ä»¶å‚¨å­˜ï¼Œå‡ ä¹éƒ½æ˜¯ç”¨çš„å¤§ç«¯å­—èŠ‚åºã€‚

> æ­£æ˜¯å› ä¸ºè¿™äº›åŸå› æ‰æœ‰äº†å­—èŠ‚åºã€‚

æ¯”å¦‚ï¼šå‰é¢æåˆ°è¿‡ï¼Œ"æª"å­—çš„ Unicode ç æ˜¯ 676Aï¼Œ"æ©§"å­—çš„ Unicode ç æ˜¯ 6A67ï¼Œå½“æˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ª UTF-16 å­—èŠ‚æµ 676A æ—¶ï¼Œè®¡ç®—æœºå¦‚ä½•è¯†åˆ«å®ƒè¡¨ç¤ºçš„æ˜¯å­—ç¬¦ "æª"è¿˜æ˜¯ å­—ç¬¦ "æ©§"å‘¢ ?

å¯¹äºå¤šå­—èŠ‚çš„ç¼–ç å•å…ƒéœ€è¦æœ‰ä¸€ä¸ªæ ‡è¯†æ˜¾å¼çš„å‘Šè¯‰è®¡ç®—æœºï¼ŒæŒ‰ç€ä»€ä¹ˆæ ·çš„é¡ºåºè§£æå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—èŠ‚åºã€‚

*   å¤§ç«¯å­—èŠ‚åº(Big-Endian)ï¼Œè¡¨ç¤ºé«˜ä½å­—èŠ‚åœ¨å‰é¢ï¼Œä½ä½å­—èŠ‚åœ¨åé¢ã€‚é«˜ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œä½ä½å­—èŠ‚ä¿å­˜åœ¨åœ¨å†…å­˜çš„é«˜åœ°å€ç«¯ã€‚
*   å°ç«¯å­—èŠ‚åº(Little-Endian)ï¼Œè¡¨ç¤ºä½ä½å­—èŠ‚åœ¨å‰ï¼Œé«˜ä½å­—èŠ‚åœ¨åé¢ã€‚é«˜ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„é«˜åœ°å€ç«¯ï¼Œè€Œä½ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ã€‚ ![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/629ce2f1.webp)

### ç®€å•èŠèŠ ArrayBuffer å’Œ TypedArrayã€DataView

#### ArrayBuffer

ArrayBuffer æ˜¯ä¸€æ®µå­˜å‚¨äºŒè¿›åˆ¶çš„å†…å­˜ï¼Œæ˜¯å­—èŠ‚æ•°ç»„ã€‚

å®ƒä¸èƒ½å¤Ÿè¢«ç›´æ¥è¯»å†™ï¼Œéœ€è¦åˆ›å»ºè§†å›¾æ¥å¯¹å®ƒè¿›è¡Œæ“ä½œï¼ŒæŒ‡å®šå…·ä½“æ ¼å¼æ“ä½œäºŒè¿›åˆ¶æ•°æ®ã€‚

å¯ä»¥é€šè¿‡å®ƒåˆ›å»ºè¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œå‚æ•°æ˜¯å†…å­˜å¤§å°(byte)ï¼Œé»˜è®¤åˆå§‹å€¼éƒ½æ˜¯ 0

#### TypedArray

ArrayBuffer çš„ä¸€ç§æ“ä½œè§†å›¾ï¼Œæ•°æ®éƒ½å­˜å‚¨åˆ°åº•å±‚çš„ ArrayBuffer ä¸­

const buf = new ArrayBuffer(8);
const int8Array = new Int8Array(buf);
int8Array\[3\] = 44;
const int16Array = new Int16Array(buf);
int16Array\[0\] = 42;
console.log(int16Array); // \[42, 11264, 0, 0\]
console.log(int8Array);  // \[42, 0, 0, 44, 0, 0, 0, 0\]

ä½¿ç”¨ int8 å’Œ int16 ä¸¤ç§æ–¹å¼æ–°å»ºçš„è§†å›¾æ˜¯ç›¸äº’å½±å“çš„ï¼Œéƒ½æ˜¯ç›´æ¥ä¿®æ”¹çš„åº•å±‚ buffer çš„æ•°æ®

#### DataView

DataView æ˜¯å¦ä¸€ç§æ“ä½œè§†å›¾ï¼Œå¹¶ä¸”æ”¯æŒè®¾ç½®å­—èŠ‚åº

const buf = new ArrayBuffer(24);
const dataview = new DataView(buf);
dataView.setInt16(1, 3000, true);  // å°ç«¯åº

### æ˜ç¡®ç”µè„‘çš„å­—èŠ‚åº

ä¸Šè¿°è®²åˆ°ï¼Œåœ¨å­˜å‚¨å¤šå­—èŠ‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šé‡‡ç”¨ä¸åŒçš„å­—èŠ‚åºæ¥åšå­˜å‚¨ã€‚é‚£å¯¹æˆ‘ä»¬çš„æ“ä½œç³»ç»Ÿæ¥è¯´æ˜¯æœ‰ä¸€ç§é»˜è®¤çš„å­—èŠ‚åºçš„ã€‚ä¸‹é¢å°±ç”¨ä¸Šè¿°çŸ¥è¯†æ¥æ˜ç¡® MacOS çš„é»˜è®¤å­—èŠ‚åºã€‚

function isLittleEndian() {
    const buf = new ArrayBuffer(2);
    const view = new Int8Array(buf);
    view\[0\]=1;
    view\[1\]=0;
    console.log(view);
    const int16Array = new Int16Array(buf);
    return int16Array\[0\] === 1;
}
console.log(isLittleEndian());

é€šè¿‡ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥å¾—å‡ºæ­¤æ¬¾ MacOS æ˜¯å°ç«¯åºåˆ—å­˜å‚¨

ä¸€ä¸ªğŸŒ°ï¼Œå¤§å®¶å¯ä»¥è®¡ç®—ä¸€ä¸‹ï¼Œæ˜¯å¦çœŸæ­£æ˜ç™½äº†å­—èŠ‚åº

const buffer = new ArrayBuffer(8);
const int8Array = new Int8Array(buffer);
int8Array\[0\] = 30;
int8Array\[1\] = 41;

const dataView = new DataView(buffer);
dataView.setInt16(2, 256, true);
const int16Array = new Int16Array(buffer);
console.log(int16Array);  // \[10526, 256, 0, 0\]
int16Array\[0\] = 256;
const int8Array1 = new Int8Array(buffer);
console.log(int8Array1);

> è™½ç„¶ TypedArray æ— æ³•æŒ‡å®šå­—èŠ‚åºï¼Œä½†æ˜¯åœ¨å­˜å‚¨çš„æ—¶å€™é‡‡ç”¨æ“ä½œç³»ç»Ÿé»˜è®¤çš„å­—èŠ‚åºã€‚æ‰€ä»¥å½“æˆ‘ä»¬è®¾ç½® int16Array\[0\] = 256 æ—¶ï¼Œå†…å­˜ä¸­å­˜å‚¨çš„ä¸º 00 01

![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/da372309.webp)

  

Base64 ç¼–ç è§£ç 
-----------

### ä»€ä¹ˆæ˜¯ Base64

Base64 æ˜¯ä¸€ç§åŸºäº64ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„æ–¹å¼ã€‚

A-Zã€a-zã€0-9ã€+ã€/ã€= 65ä¸ªå­—ç¬¦ç»„æˆï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ = ç”¨äºè¡¥ä½æ“ä½œ

const \_base64Str = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';

### Base64 åŸç†

é™¤å» = è¿™ä¸ªè¡¥ä½ç¬¦å·ï¼Œ64ä¸ªå­—ç¬¦(å³2^6)ï¼Œå¯è¡¨ç¤ºäºŒè¿›åˆ¶ 000000 è‡³111111å…±6ä¸ªæ¯”ç‰¹ä½ï¼Œä¸€ä¸ªå­—èŠ‚æœ‰8ä¸ªæ¯”ç‰¹ä½ï¼Œå› æ­¤å¯ä»¥æ¨ç®—å‡º3ä¸ªå­—èŠ‚çš„æ•°æ®éœ€è¦ç”¨4ä¸ª Base64 å­—ç¬¦è¡¨ç¤º

ä¸¾ä¸ªğŸŒ°ï¼Œthis çš„ Base64 ç¼–ç ä¸º `dGhpcw==` ï¼Œå…·ä½“ç¼–ç å¦‚ä¸‹

![](https://note-2019-images.oss-cn-hangzhou.aliyuncs.com/5b7f30d5.webp)

### Base64 ç¼–ç è§£ç å®ç°

åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œå®ç° Base64 ç¼–ç é€šå¸¸ä½¿ç”¨ btoa å’Œ atob å®ç°ç¼–ç å’Œè§£ç ï¼Œä¸‹é¢æ¥å°è¯•å®ç° btoa/atob

å‰ç½®æ‰€éœ€è¦äº†è§£å‡½æ•°

*   è·å–ç›¸åº”å­—ç¬¦ ASCII ç æ–¹æ³• String.charCodeAt(index)
*   å–å¾— Base64 å¯¹åº”çš„å­—ç¬¦æ–¹æ³• String.charAt(index)

**ç¼–ç å®ç°æ€è·¯**

*   ä¸‰ä¸ªå­—ç¬¦åˆ†åˆ«ä¸º char1/char2/char3ï¼Œå¯¹åº”çš„ base64 å­—ç¬¦ä¸º encode1/encode2/encode3/encode4
*   encode1 æ˜¯ char1 å–å‰å…­ä½ï¼Œå³ char1 å³ç§»2ä½ï¼Œencode1 = char1 \>\> 2
*   encode2 æ˜¯ char1 åä¸¤ä½ + char2 å‰å››ä½ç»„æˆï¼Œencode2 = ((char1 & 3) << 4) | (char2 \>\> 4)
*   encode3 æ˜¯ char2 åå››ä½ + char3 å‰ä¸¤ä½ç»„æˆï¼Œencode3 = ((char2 & 15) << 2) | (char3 \>\> 6)
*   encode4 æ˜¯ char3 çš„åå…­ä½ï¼Œencode4 = char3 & 63

function encodeBase64(input) {
    if (!input) return;
    let base64String = "";
    for (let i = 0; i < input.length; ) {
        const char1 = input.charCodeAt(i++);
        const encode1 = char1 \>\> 2;
        const char2 = input.charCodeAt(i++);
        const encode2 = ((char1 & 3) << 4) | (char2 \>\> 4);
        const char3 = input.charCodeAt(i++);
        let encode3 = ((char2 & 15) << 2) | (char3 \>\> 6);
        let encode4 = char3 & 63;
        if (Number.isNaN(char2)) encode3 = encode4 = 64;
        if (Number.isNaN(char3)) encode4 = 64;
        base64String +=
            \_base64Str.charAt(encode1) +
            \_base64Str.charAt(encode2) +
            \_base64Str.charAt(encode3) +
            \_base64Str.charAt(encode4);
    }
    return base64String;
}

**è§£ç å®ç°æ€è·¯**

*   base64 å­—ç¬¦ä¸º encode1/encode2/encode3/encode4ï¼Œä¸‰ä¸ªå­—ç¬¦åˆ†åˆ«ä¸º char1/char2/char3
*   char1 æ˜¯ encode1 + encode2 å‰ä¸¤ä½ï¼Œchar1 = (encode1 << 2) | (encode2 \>\> 4)
*   char2 æ˜¯ encode2 åå››ä½ + encode3 å‰å››ä½ï¼Œchar2 = ((encode2 & 15) << 4) | (encode3 \>\> 2)
*   char3 æ˜¯ encode3 åä¸¤ä½ + encode4ï¼Œchar3 = ((encode3 & 3) << 6) | encode4

function decodeBase64(input) {
    if (!input) return;
    let output = "";
    for (let i = 0; i < input.length; ) {
        const encode1 = \_base64Str.indexOf(input.charAt(i++));
        const encode2 = \_base64Str.indexOf(input.charAt(i++));
        const encode3 = \_base64Str.indexOf(input.charAt(i++));
        const encode4 = \_base64Str.indexOf(input.charAt(i++));
        const char1 = (encode1 << 2) | (encode2 \>\> 4);
        const char2 = ((encode2 & 15) << 4) | (encode3 \>\> 2);
        const char3 = ((encode3 & 3) << 6) | encode4;
        output += String.fromCharCode(char1);
        if (encode3 != 64) {
            output += String.fromCharCode(char2);
        }
        if (encode4 != 64) {
            output += String.fromCharCode(char3);
        }
    }
    return output;
}

### ä¸€äº›é—®é¢˜

å½“æˆ‘ä»¬ä½¿ç”¨ä¸Šè¿°ä»£ç å»ç¼–ç ä¸­æ–‡çš„æ—¶å€™ï¼Œå°±èƒ½å¤Ÿå‘ç°ä¸€äº›é—®é¢˜äº†ã€‚

console.log(encodeBase64("éœœåº"));                // 8=
console.log(decodeBase64(encodeBase64("éœœåº")));  // Ã´

å…¶å®æ˜¯å½“å­—ç¬¦çš„ Unicode ç å¤§äº255æ—¶ï¼Œä¸Šè¿°é­”æ³•å°±ä¼šå¤±çµã€‚åŒæ ·çš„ window ä¸Šçš„ btoa å’Œ atob æ–¹æ³•ä¹Ÿä¼šå¤±æ•ˆã€‚

éœœåº ä¸¤ä¸ªå­—çš„ Unicode åˆ†åˆ«ä¸º 38684/24207ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›æ•°å­—è½¬åŒ–ä¸ºå¤šä¸ª255å†…çš„æ•°å­—ï¼Œä¹Ÿå°±æ˜¯ç”¨å¤šä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬ä¸Šè¿° Unicode è½¬ UTF-8 çš„æ–¹æ³•ï¼Œå¾—åˆ°å¯¹åº”çš„å­—ç¬¦ï¼Œåœ¨å¯¹é½è¿›è¡Œç¼–ç 

function encodeTransform(input) {
    if (!input) return;
    const byteArray = \[\];
    for (let i = 0; i < input.length; i++) {
        const code = input.charCodeAt(i); // è·å–åˆ°å½“å‰å­—ç¬¦çš„ Unicode ç 
        if (code < 128) {
            byteArray.push(code);
        } else if (code \>\= 128 && code < 2048) {
            byteArray.push((code \>\> 6) | 192);
            byteArray.push((code & 63) | 128);
        } else if (code \>\= 2048 && code < 65535) {
            byteArray.push((code \>\> 12) | 224);
            byteArray.push(((code \>\> 6) & 63) | 128);
            byteArray.push((code & 63) | 128);
        }
    }
    return byteArray;  // è¿”å› UTF-8 ç¼–ç çš„æ•°æ®
}

function encodeBase64(input) {
    if (!input) return;
    let base64String = "";
    const byteArray = encodeTransform(input);
    for (let i = 0; i < byteArray.length; ) {
        const char1 = byteArray\[i++\];
        const encode1 = char1 \>\> 2;
        const char2 = byteArray\[i++\];
        const encode2 = ((char1 & 3) << 4) | (char2 \>\> 4);
        const char3 = byteArray\[i++\];
        let encode3 = ((char2 & 15) << 2) | (char3 \>\> 6);
        let encode4 = char3 & 63;
        if (Number.isNaN(char2)) encode3 = encode4 = 64;
        if (Number.isNaN(char3)) encode4 = 64;
        base64String +=
            \_base64Str.charAt(encode1) +
            \_base64Str.charAt(encode2) +
            \_base64Str.charAt(encode3) +
            \_base64Str.charAt(encode4);
    }
    return base64String;
}

console.log(encodeBase64("éœœåº"));     // 6Zyc5bqP

åŒæ ·çš„æˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹è§£ç çš„å†…å®¹åšç›¸åº”çš„è½¬æ¢ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ Base64 è§£ç å®Œæˆçš„æ•°æ®ï¼Œé€šè¿‡UTF-8çš„ç¼–ç è§„åˆ™è¿˜åŸå› Unicode ç ï¼Œæ‰¾åˆ°å¯¹åº”çš„å­—ç¬¦ã€‚

function decodeTransform(byteArray) {
    let i = 0;
    const output = \[\];
    while (i < byteArray.length) {
        const code = byteArray\[i\];
        if (code < 128) {
            output.push(code);
            i++;
        } else if (code \> 191 && code < 224) {
            const code1 = byteArray\[i + 1\];
            output.push(((code & 31) << 6) | (code1 & 63));
            i += 2;
        } else {
            const code1 = byteArray\[i + 1\];
            const code2 = byteArray\[i + 2\];
            output.push(
                ((code & 15) << 12) | ((code1 & 63) << 6) | (code2 & 63)
            );
            i += 3;
        }
    }
    return output.map((item) =\> String.fromCharCode(item)).join("");
}

function decodeBase64(input) {
    if (!input) return;
    const byteArray = \[\];
    for (let i = 0; i < input.length; ) {
        const encode1 = \_base64Str.indexOf(input.charAt(i++));
        const encode2 = \_base64Str.indexOf(input.charAt(i++));
        const encode3 = \_base64Str.indexOf(input.charAt(i++));
        const encode4 = \_base64Str.indexOf(input.charAt(i++));
        const char1 = (encode1 << 2) | (encode2 \>\> 4);
        const char2 = ((encode2 & 15) << 4) | (encode3 \>\> 2);
        const char3 = ((encode3 & 3) << 6) | encode4;
        byteArray.push(char1);
        if (encode3 != 64) {
            byteArray.push(char2);
        }
        if (encode4 != 64) {
            byteArray.push(char3);
        }
    }
    return decodeTransform(byteArray);
}

  

æ€»ç»“
--

åœ¨æœ¬æ–‡ä¸­ï¼Œé‡ç‚¹æ˜¯è¦å®ç° Base64 ç¼–ç çš„å†…å®¹ï¼Œç„¶åå…ˆç»™å¤§å®¶è®²è¿°äº†ç›¸å…³å­—ç¬¦é›†(ASCII/Unicode)å‡ºç°çš„åŸå› ã€‚

Unicode ç¼–ç ç›¸å…³çš„ç¼ºç‚¹ï¼Œç”±æ­¤å¼•å‡ºäº† UTF-8/UTF-16 ç¼–ç ã€‚

å¯¹äº UTF-16 æ¥è¯´ï¼Œæœ€å°çš„ç¼–ç å•å…ƒä¸ºä¸¤ä¸ªå­—èŠ‚ï¼Œç”±æ­¤å¼•å‡ºäº†å­—èŠ‚åºçš„å†…å®¹ã€‚

å½“æˆ‘ä»¬æœ‰äº†ä¸Šè¿°çŸ¥è¯†ä¹‹åï¼Œæœ€åå¼€å§‹ Base64 ç¼–ç çš„å®ç°ã€‚

å‚è€ƒé“¾æ¥
----

*   [å­—ç¬¦ç¼–ç ç¬”è®°ï¼šASCIIï¼ŒUnicode å’Œ UTF-8](https://link.juejin.cn/?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2007%2F10%2Fascii_unicode_and_utf-8.html)
*   [å®ç° Base64 çš„ç¼–ç è§£ç ](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fzxpsuper%2Fblog%2Fblob%2Fmaster%2Fjs%2FBase64%25E7%259A%2584%25E7%25BC%2596%25E7%25A0%2581%25E8%25A7%25A3%25E7%25A0%2581.md)

**_æœ¬æ–‡æ­£åœ¨å‚åŠ _**[**_ã€Œé‡‘çŸ³è®¡åˆ’ã€_**](https://juejin.cn/post/7207698564641996856/)
    